!function(){"use strict";angular.module("dashboard",[])}(),function(){"use strict";angular.module("dashboard").directive("displayComponent",function(){return{restrict:"E",scope:{component:"=",dashboard:"="},templateUrl:"dashboard.component.directive.html",link:function(t,n,o){t.params=t.component.params,t.component.scope&&(t.scope=t.component.scope),t.component.states["default"]&&t.component.states["default"].controller&&t.component.states["default"].controller(),t.openExtended=function(n){t.dashboard.isStateSorting||(t.dashboard.enableExtended(),t.component.isExtended=!0,t.component.states.extended&&t.component.states.extended.controller&&t.component.states.extended.controller())},t.closeExtended=function(n){t.dashboard.isStateSorting||(t.dashboard.isExtended=!1,t.component.isExtended=!1,t.component.states["default"]&&t.component.states["default"].controller&&t.component.states["default"].controller())},t.openSettings=function(n){t.dashboard.isStateSorting||(t.component.displaySettings=!0,t.component.states.settings&&t.component.states.settings.controller&&t.component.states.settings.controller())},t.closeSettings=function(n){t.dashboard.isStateSorting||(t.component.displaySettings=!1,t.component.states["default"]&&t.component.states["default"].controller&&t.component.states["default"].controller())}}}})}(),function(){"use strict";angular.module("dashboard").directive("dashboard",["dashboardFactory",function(t){var n;return{restrict:"E",scope:{id:"@",width:"@",columns:"@",columnsMinWidth:"@"},templateUrl:"dashboard.directive.html",controller:["$scope",function(o){var e=$(window).width();o.dashboard=t.get(o.id),o.dashboard.setOptions({width:o.width,columns:o.columns,columnsMinWidth:o.columnsMinWidth}),o.dashboard.refresh(),window.addEventListener("resize",function(t){$(window).width()!==e&&(clearTimeout(n),n=setTimeout(function(){o.dashboard.refresh(),o.$apply()},150))},!0)}]}}])}(),function(){"use strict";function t(t){function n(n){return s[n]||(s[n]=new t,s[n].id=n),s[n]}function o(t){s[t]&&delete s[t]}function e(){s={}}var s={},i={get:n,remove:o,reinitialize:e};return i}angular.module("dashboard").factory("dashboardFactory",t),t.$inject=["dashboardObject"]}(),function(){"use strict";function t(t){return function(n){function o(t){return t.id=g.id+"-"+g.nbComponent,g.nbComponent++,g.components.push(t),t}function e(){var t=g.options;g.isStateSorting&&g.toggleSortable();var n=$("#"+g.id).parent().width();console.log(n),"auto"!==t.width&&t.width<n&&(n=t.width),console.log(n);var o=parseInt(n/t.columnsMinWidth);o>m&&(o=m),p!==o&&(p=o,o<t.columns?g.columnsWidth=100/o+"%":o>t.columns?g.columnsWidth=100/o+"%":g.columnsWidth=100/t.columns+"%"),t.columns=o,console.log(t.columns),g.grid=[];for(var e=t.columns-1;e>=0;e--)g.grid[e]=[];g.sortable=null,g.components.forEach(function(n){var o=0,e=0,s=t.columns;if(n.positions&&n.positions[s])o=n.positions[s].column,e=n.positions[s].position;else{if("shorter"===t.algo)for(var i=t.columns-1;i>=0;i--)g.grid[i]?g.grid[i].length<=g.grid[o].length&&(o=i):(o=i,g.grid[i]=[]);else o="random"===t.algo?Math.floor(Math.random()*t.columns):0;g.grid[o]&&(e=g.grid[o].length),n.positions||(n.positions={}),n.positions[s]={},n.positions[s].column=o,n.positions[s].position=e}g.grid[o]||(g.grid[o]=[]),g.grid[o].splice(e,0,n)})}function s(t){Object.keys(t).forEach(function(n){t[n]&&(g.options[n]=t[n],"columns"===n&&(m=t[n]))})}function i(){var t=[];return g.grid.forEach(function(n){n.forEach(function(n){t.push({name:n.name,params:n.params,positions:n.positions})})}),JSON.stringify(t)}function a(n){var e=JSON.parse(n);e.forEach(function(n){if(t.has(n.name)){var e=o(new t.get(n.name)(n.params));e.positions=n.positions}})}function d(t){var n=t.from.id.replace("column",""),o=t.to.id.replace("column",""),e=g.grid[n][t.oldIndex];g.grid[n].splice(t.oldIndex,1);var s=g.options.columns;e.positions[s].column=o,g.grid[o].splice(t.newIndex,0,e),g.grid[n].forEach(function(t,o){t.positions[s].column=parseInt(n),t.positions[s].position=parseInt(o)}),g.grid[o].forEach(function(t,n){t.positions[s].column=parseInt(o),t.positions[s].position=parseInt(n)})}function r(){if(!g.sortable){g.sortable=[];for(var t=0;t<g.grid.length;t++)g.sortable.push(Sortable.create(document.getElementById("column"+t),{group:g.id,draggable:".component",disabled:!g.isStateSorting,handle:".sortable-handle",onAdd:function(t){d(t)},onUpdate:function(t){d(t)}}))}}function c(){g.options.sortable?(r(),g.isStateSorting=!g.isStateSorting,g.sortable.forEach(function(t){t.option("disabled",!g.isStateSorting)})):console.log("This dashboard does not allow sorting (see options configuration).")}function l(){g.isExtended=!0}function u(){g.isExtended=!1,g.components.forEach(function(t){t.isExtended&&(t.isExtended=!1)})}var p,m,h={id:null,nbComponent:0,isExtended:!1,components:[],grid:[],isStateSorting:!1,sortable:null,columnsWidth:null,options:{width:"auto",columns:"2",columnsMinWidth:null,sortable:!0,algo:"shorter"},add:o,setOptions:s,toString:i,fromString:a,enableExtended:l,disableExtended:u,refresh:e,toggleSortable:c},g=h;return g}}angular.module("dashboard").service("dashboardObject",t),t.$inject=["$injector"]}(),angular.module("dashboard").run(["$templateCache",function(t){t.put("dashboard.component.directive.html",'<div id="component.id" class="dashboard-component"><div class="default" data-ng-include="component.states.default.template" data-ng-if="!dashboard.isExtended && !component.displaySettings"></div><div class="extended" data-ng-include="component.states.extended.template" data-ng-if="component.isExtended"></div><div class="settings" data-ng-include="component.states.settings.template" data-ng-if="component.displaySettings && !dashboard.isExtended"></div></div>'),t.put("dashboard.directive.html",'<div id="dashboard-{{ id }}" class="dashboard-container" data-ng-style="{ \'width\': dashboard.options.width }"><div id="column{{$index+0}}" class="dashboard-column" data-ng-class="{ \'placeholder\' : dashboard.isStateSorting, \'shake-effect\': dashboard.isStateSorting }" data-ng-repeat="column in dashboard.grid" data-ng-style="{ \'max-width\': dashboard.columnsWidth, \'width\': dashboard.columnsWidth }"><div class="component" data-ng-repeat="component in column"><display-component component="component" dashboard="dashboard"></display-component></div></div><div class="clearfix"></div></div>')}]);
//# sourceMappingURL=angular-dashboard-fluance.min.js.map
