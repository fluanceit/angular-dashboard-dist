!function(){"use strict";angular.module("dashboard",[])}(),function(){"use strict";angular.module("dashboard").directive("displayComponent",function(){return{restrict:"E",scope:{component:"=",dashboard:"="},templateUrl:"dashboard.component.directive.html",link:function(t,o,n){t.params=t.component.params,t.component.scope&&(t.scope=t.component.scope),t.component.states["default"]&&t.component.states["default"].controller&&t.component.states["default"].controller(),t.openExtended=function(){t.dashboard.isStateSorting||(t.dashboard.isExtended=!0,t.component.isExtended=!0,t.component.states.extended&&t.component.states.extended.controller&&t.component.states.extended.controller())},t.closeExtended=function(){t.dashboard.isStateSorting||(t.dashboard.isExtended=!1,t.component.isExtended=!1,t.component.states["default"]&&t.component.states["default"].controller&&t.component.states["default"].controller())},t.openSettings=function(){t.dashboard.isStateSorting||(t.component.displaySettings=!0,t.component.states.settings&&t.component.states.settings.controller&&t.component.states.settings.controller())},t.closeSettings=function(){t.dashboard.isStateSorting||(t.component.displaySettings=!1,t.component.states["default"]&&t.component.states["default"].controller&&t.component.states["default"].controller())}}}})}(),function(){"use strict";angular.module("dashboard").directive("dashboard",["dashboardFactory",function(t){function o(t,o,a){i=parseInt(n/o),i>d&&(i=d),e!==i&&(e=i,s=t>i?100/i+"%":i>t?100/i+"%":100/t+"%"),void 0!==a&&a()}var n,e,i,s,d,a;return{restrict:"E",scope:{id:"@",width:"@",columns:"@",columnsMinWidth:"@"},templateUrl:"dashboard.directive.html",controller:["$scope",function(r){n=$("#"+r.id).parent().width(),"auto"!==r.width&&n>r.width&&(n=r.width),d=r.columns,o(r.columns,r.columnsMinWidth),r.columnsWidth=s,r.dashboard=t.get(r.id),r.dashboard.setOptions({width:r.width,columns:i,columnsMinWidth:r.columnsMinWidth}),r.dashboard.drawGrid(),e=r.columns,window.addEventListener("resize",function(){clearTimeout(a),a=setTimeout(function(){n=document.getElementById(r.id).offsetWidth,o(r.columns,r.columnsMinWidth,function(){i!==r.dashboard.options.columns&&(r.columnsWidth=s,r.dashboard.setOptions({columns:i}),r.dashboard.drawGrid(),r.$apply())})},150)},!0)}]}}])}(),function(){"use strict";function t(t){function o(o){return i[o]||(i[o]=new t,i[o].id=o),i[o]}function n(t){i[t]&&delete i[t]}function e(){i={}}var i={},s={get:o,remove:n,reinitialize:e};return s}angular.module("dashboard").factory("dashboardFactory",t),t.$inject=["dashboardObject"]}(),function(){"use strict";function t(t){return function(o){function n(t){return t.id=p.id+"-"+p.nbComponent,p.nbComponent++,p.components.push(t),t}function e(){p.isStateSorting&&p.toggleSortable(),p.grid=[];for(var t=p.options.columns-1;t>=0;t--)p.grid[t]=[];p.sortable=null,p.components.forEach(function(t){var o=0,n=0,e=p.options.columns;if(t.positions&&t.positions[e])o=t.positions[e].column,n=t.positions[e].position;else{if("shorter"===p.options.algo)for(var i=p.options.columns-1;i>=0;i--)p.grid[i]?p.grid[i].length<=p.grid[o].length&&(o=i):(o=i,p.grid[i]=[]);else o="random"===p.options.algo?Math.floor(Math.random()*p.options.columns):0;p.grid[o]&&(n=p.grid[o].length),t.positions||(t.positions={}),t.positions[e]={},t.positions[e].column=o,t.positions[e].position=n}p.grid[o]||(p.grid[o]=[]),p.grid[o].splice(n,0,t)})}function i(t){Object.keys(t).forEach(function(o){t[o]&&(p.options[o]=t[o])})}function s(){var t=[];return p.grid.forEach(function(o){o.forEach(function(o){t.push({name:o.name,params:o.params,positions:o.positions})})}),JSON.stringify(t)}function d(o){var e=JSON.parse(o);e.forEach(function(o){if(t.has(o.name)){var e=n(new t.get(o.name)(o.params));e.positions=o.positions}})}function a(t){var o=t.from.id.replace("column",""),n=t.to.id.replace("column",""),e=p.grid[o][t.oldIndex];p.grid[o].splice(t.oldIndex,1);var i=p.options.columns;e.positions[i].column=n,p.grid[n].splice(t.newIndex,0,e),p.grid[o].forEach(function(t,n){t.positions[i].column=parseInt(o),t.positions[i].position=parseInt(n)}),p.grid[n].forEach(function(t,o){t.positions[i].column=parseInt(n),t.positions[i].position=parseInt(o)})}function r(){if(!p.sortable){p.sortable=[];for(var t=0;t<p.grid.length;t++)p.sortable.push(Sortable.create(document.getElementById("column"+t),{group:p.id,draggable:".component",disabled:!p.isStateSorting,handle:".sortable-handle",onAdd:function(t){a(t)},onUpdate:function(t){a(t)}}))}}function c(){p.options.sortable?(r(),p.isStateSorting=!p.isStateSorting,p.sortable.forEach(function(t){t.option("disabled",!p.isStateSorting)})):console.log("This dashboard does not allow sorting (see options configuration).")}function l(){p.isExtended=!1,p.components.forEach(function(t){t.isExtended&&(t.isExtended=!1)})}var u={id:null,nbComponent:0,isExtended:!1,components:[],grid:[],isStateSorting:!1,sortable:null,options:{width:"auto",columns:"2",columnsMinWidth:null,sortable:!0,algo:"shorter"},add:n,setOptions:i,toString:s,fromString:d,disableExtended:l,drawGrid:e,toggleSortable:c},p=u;return p}}angular.module("dashboard").service("dashboardObject",t),t.$inject=["$injector"]}(),angular.module("dashboard").run(["$templateCache",function(t){t.put("dashboard.component.directive.html",'<div id="component.id" class="dashboard-component"><div class="default" data-ng-include="component.states.default.template" data-ng-if="!dashboard.isExtended && !component.displaySettings"></div><div class="extended" data-ng-include="component.states.extended.template" data-ng-if="component.isExtended"></div><div class="settings" data-ng-include="component.states.settings.template" data-ng-if="component.displaySettings && !dashboard.isExtended"></div></div>'),t.put("dashboard.directive.html",'<div id="{{ id }}" class="dashboard-container" data-ng-style="{ \'width\': width }"><div id="column{{$index+0}}" class="dashboard-column" data-ng-class="{ \'placeholder\' : dashboard.isStateSorting, \'shake-effect\': dashboard.isStateSorting }" data-ng-repeat="column in dashboard.grid" data-ng-style="{ \'max-width\': columnsWidth, \'width\': columnsWidth }"><div class="component" data-ng-repeat="component in column"><display-component component="component" dashboard="dashboard"></display-component></div></div><div class="clearfix"></div></div>')}]);
//# sourceMappingURL=angular-dashboard-fluance.js.map
