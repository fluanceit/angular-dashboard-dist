!function(){"use strict";angular.module("dashboard",[])}(),function(){"use strict";angular.module("dashboard").directive("displayComponent",function(){return{restrict:"E",scope:{component:"=",dashboard:"="},templateUrl:"dashboard.component.directive.html",link:function(t,o,n){t.params=t.component.params,t.component.scope&&(t.scope=t.component.scope),t.component.states["default"]&&t.component.states["default"].controller&&t.component.states["default"].controller(),t.openExtended=function(o){t.dashboard.isStateSorting||(t.dashboard.enableExtended(),t.component.isExtended=!0,t.component.states.extended&&t.component.states.extended.controller&&t.component.states.extended.controller())},t.closeExtended=function(o){t.dashboard.isStateSorting||(t.dashboard.isExtended=!1,t.component.isExtended=!1,t.component.states["default"]&&t.component.states["default"].controller&&t.component.states["default"].controller())},t.openSettings=function(o){t.dashboard.isStateSorting||(t.component.displaySettings=!0,t.component.states.settings&&t.component.states.settings.controller&&t.component.states.settings.controller())},t.closeSettings=function(o){t.dashboard.isStateSorting||(t.component.displaySettings=!1,t.component.states["default"]&&t.component.states["default"].controller&&t.component.states["default"].controller())}}}})}(),function(){"use strict";angular.module("dashboard").directive("dashboard",["dashboardFactory",function(t){var o;return{restrict:"E",scope:{id:"@",width:"@",columns:"@",columnsMinWidth:"@"},templateUrl:"dashboard.directive.html",controller:["$scope",function(n){var e=$(window).width();n.dashboard=t.get(n.id),n.dashboard.setOptions({width:n.width,columns:n.columns,columnsMinWidth:n.columnsMinWidth}),n.dashboard.refresh(),window.addEventListener("resize",function(t){$(window).width()!==e&&(clearTimeout(o),o=setTimeout(function(){n.dashboard.refresh(),n.$apply()},150))},!0)}]}}])}(),function(){"use strict";function t(t){function o(o){return s[o]||(s[o]=new t,s[o].id=o),s[o]}function n(t){s[t]&&delete s[t]}function e(){s={}}var s={},i={get:o,remove:n,reinitialize:e};return i}angular.module("dashboard").factory("dashboardFactory",t),t.$inject=["dashboardObject"]}(),function(){"use strict";function t(t){return function(o){function n(t){return t.id=g.id+"-"+g.nbComponent,g.nbComponent++,g.components.push(t),t}function e(){var t=g.options;g.isStateSorting&&g.toggleSortable();var o=$("#"+g.id).parent().width();console.log(o),"auto"!==t.width&&t.width<o&&(o=t.width),console.log(o);var n=parseInt(o/t.columnsMinWidth);n>m&&(n=m),p!==n&&(p=n,n<t.columns?g.columnsWidth=100/n+"%":n>t.columns?g.columnsWidth=100/n+"%":g.columnsWidth=100/t.columns+"%"),t.columns=n,console.log(t.columns),g.grid=[];for(var e=t.columns-1;e>=0;e--)g.grid[e]=[];g.sortable=null,g.components.forEach(function(o){var n=0,e=0,s=t.columns;if(o.positions&&o.positions[s])n=o.positions[s].column,e=o.positions[s].position;else{if("shorter"===t.algo)for(var i=t.columns-1;i>=0;i--)g.grid[i]?g.grid[i].length<=g.grid[n].length&&(n=i):(n=i,g.grid[i]=[]);else n="random"===t.algo?Math.floor(Math.random()*t.columns):0;g.grid[n]&&(e=g.grid[n].length),o.positions||(o.positions={}),o.positions[s]={},o.positions[s].column=n,o.positions[s].position=e}g.grid[n]||(g.grid[n]=[]),g.grid[n].splice(e,0,o)})}function s(t){Object.keys(t).forEach(function(o){t[o]&&(g.options[o]=t[o],"columns"===o&&(m=t[o]))})}function i(){var t=[];return g.grid.forEach(function(o){o.forEach(function(o){t.push({name:o.name,params:o.params,positions:o.positions})})}),JSON.stringify(t)}function a(o){var e=JSON.parse(o);e.forEach(function(o){if(t.has(o.name)){var e=n(new t.get(o.name)(o.params));e.positions=o.positions}})}function d(t){var o=t.from.id.replace("column",""),n=t.to.id.replace("column",""),e=g.grid[o][t.oldIndex];g.grid[o].splice(t.oldIndex,1);var s=g.options.columns;e.positions[s].column=n,g.grid[n].splice(t.newIndex,0,e),g.grid[o].forEach(function(t,n){t.positions[s].column=parseInt(o),t.positions[s].position=parseInt(n)}),g.grid[n].forEach(function(t,o){t.positions[s].column=parseInt(n),t.positions[s].position=parseInt(o)})}function r(){if(!g.sortable){g.sortable=[];for(var t=0;t<g.grid.length;t++)g.sortable.push(Sortable.create(document.getElementById("column"+t),{group:g.id,draggable:".component",disabled:!g.isStateSorting,handle:".sortable-handle",scroll:!0,scrollSensitivity:30,scrollSpeed:10,onAdd:function(t){d(t)},onUpdate:function(t){d(t)}}))}}function c(){g.options.sortable?(r(),g.isStateSorting=!g.isStateSorting,g.sortable.forEach(function(t){t.option("disabled",!g.isStateSorting)})):console.log("This dashboard does not allow sorting (see options configuration).")}function l(){g.isExtended=!0}function u(){g.isExtended=!1,g.components.forEach(function(t){t.isExtended&&(t.isExtended=!1)})}var p,m,h={id:null,nbComponent:0,isExtended:!1,components:[],grid:[],isStateSorting:!1,sortable:null,columnsWidth:null,options:{width:"auto",columns:"2",columnsMinWidth:null,sortable:!0,algo:"shorter"},add:n,setOptions:s,toString:i,fromString:a,enableExtended:l,disableExtended:u,refresh:e,toggleSortable:c},g=h;return g}}angular.module("dashboard").service("dashboardObject",t),t.$inject=["$injector"]}(),angular.module("dashboard").run(["$templateCache",function(t){t.put("dashboard.component.directive.html",'<div id="component.id" class="dashboard-component"><div class="default" data-ng-include="component.states.default.template" data-ng-if="!dashboard.isExtended && !component.displaySettings"></div><div class="extended" data-ng-include="component.states.extended.template" data-ng-if="component.isExtended"></div><div class="settings" data-ng-include="component.states.settings.template" data-ng-if="component.displaySettings && !dashboard.isExtended"></div></div>'),t.put("dashboard.directive.html",'<div id="dashboard-{{ id }}" class="dashboard-container" data-ng-style="{ \'width\': dashboard.options.width }"><div id="column{{$index+0}}" class="dashboard-column" data-ng-class="{ \'placeholder\' : dashboard.isStateSorting, \'shake-effect\': dashboard.isStateSorting }" data-ng-repeat="column in dashboard.grid" data-ng-style="{ \'max-width\': dashboard.columnsWidth, \'width\': dashboard.columnsWidth }"><div class="component" data-ng-repeat="component in column"><display-component component="component" dashboard="dashboard"></display-component></div></div><div class="clearfix"></div></div>')}]);
//# sourceMappingURL=angular-dashboard-fluance.min.js.map
